pipeline {
  agent any
  tools {
    maven 'M2_HOME'
  }
  environment {
        // This can be nexus3 or nexus2
        NEXUS_VERSION = "nexus2"
        // This can be http or https
        NEXUS_PROTOCOL = "http"
        // Where your Nexus is running
        NEXUS_URL = "http://localhost:8081/nexus"
        // Repository where we will upload the artifact
        NEXUS_REPOSITORY = "Releases"
        // Jenkins credential id to authenticate to Nexus OSS
        NEXUS_CREDENTIAL_ID = "15ed9237-978d-4f7a-b0c5-73276bfdd52a"
   
  stages {
    stage('Checkout') {
       steps {
         echo 'Checkout'
       }
    }
    stage ('compile') {
      steps {
        bat 'mvn compile'	 
      }
	 
    }
    stage ('test') {
      steps {
        bat 'mvn test'	 
      }
	 
    }
   
    stage ('Build') {
      steps {
        bat 'mvn package'	 
      }
	 
    }
    stage("publish to nexus") {
            steps {
	      nexusArtifactUploader(
                            nexusVersion: 3,
                            protocol: http,
                            nexusUrl: NEXUS_URL,
                            groupId: com.mkyong,
                            version: 1.0,
                            repository: Releases,
                            credentialsId: NEXUS_CREDENTIAL_ID,
              );
	   }
    }
    
  }
}
